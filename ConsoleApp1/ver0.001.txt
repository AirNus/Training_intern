using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Globalization;
namespace ConsoleApp1
{
    class Program
    {       
        static void Main(string[] args)
        {
            //нужно продумать возможность добавления в программу нового товара
            NumberFormatInfo nfi = new CultureInfo("ru-RU", false).NumberFormat;
            nfi.NumberDecimalSeparator = ".";
            string today;
            DateTime date = new DateTime();          
            date = DateTime.Now;
            today = date.DayOfWeek.ToString();          
            int hours = 8; // время открытия магазина в 8 часов
            int[,] InfoGoods = new int[8, 3];   // двумерный массив который будет хранить доп.информацию о товарах(кол-во покупок\закупок)
            double TotalSumm = 0, //Общая сумма заработанных деняк
                Costs; // Расходы на дозакупку товара
            Random rand = new Random();
            string[] rows = { ";" };
            string pathCSV = System.IO.Path.GetFullPath(@"data.CSV");
            using (StreamReader stReader = new StreamReader(new FileStream("data.csv", FileMode.Open),Encoding.GetEncoding(1251)))
            {
                rows = stReader.ReadToEnd().Split(rows, StringSplitOptions.RemoveEmptyEntries);                
            }
            //////////////////////////////////////////

            double price_goods; // цена на покупаемый товар с наценкой
            int count_people = rand.Next(1,11); // количество людей которые зайдут в магазин в этот час
            int goods_purchased, // количество купленных товаров одним человеком
                goods, // указывает какой именно товар выбрал клиент
                quantity, // указывает какое количество определенного товара купил клиент
                goods_purchased_now; // показывает сколько  товаров куплено клиентом на данный момент
            while(count_people != 0)
            {
                goods_purchased_now = 0;
                goods_purchased = rand.Next(0, 11);
                while(goods_purchased_now != goods_purchased)
                {
                    goods = rand.Next(1, 9);                    
                    quantity = rand.Next(1, goods_purchased - goods_purchased_now + 1);
                    if ((today == "Saturday" || today == "Sunday") && quantity < 3)
                    {
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.15);
                        TotalSumm += price_goods * quantity;
                        Console.WriteLine($"Куплено {quantity} товаров {rows[goods * 6]} по цене {price_goods}  с наценкой 15%");
                    }
                    else if (hours > 18 && hours < 20)
                    {
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.08);
                        TotalSumm += price_goods * quantity;
                        Console.WriteLine($"Куплено {quantity} товаров {rows[goods * 6]} по цене {price_goods}  с наценкой 8%");
                    }
                    else if ((today != "Saturday" && today != "Sunday") && quantity > 2)
                    {
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.1);
                        TotalSumm += price_goods * 2;
                        Console.WriteLine($"Куплено 2 товара {rows[goods * 6]} по цене {price_goods}  с наценкой 10%");
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.07);
                        TotalSumm += price_goods * (quantity - 2);
                        Console.WriteLine($"Так же куплено {quantity - 2} товаров {rows[goods * 6]} по цене {price_goods}  с наценкой 7%");
                    }
                    else if ((today == "Saturday" || today == "Sunday") && quantity > 2)
                    {
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.15);
                        TotalSumm += price_goods * 2;
                        Console.WriteLine($"Куплено 2 товара {rows[goods * 6]} по цене {price_goods}  с наценкой 15%");
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.07);
                        TotalSumm += price_goods * (quantity - 2);
                        Console.WriteLine($"Так же куплено {quantity - 2} товаров {rows[goods * 6]} по цене {price_goods}  с наценкой 7%");
                    }
                    else
                    {
                        price_goods = (Convert.ToDouble(rows[goods * 6 + 1], nfi) * 1.1);
                        TotalSumm += price_goods * quantity;
                        Console.WriteLine($"Куплено {quantity} товаров {rows[goods * 6]} по цене {price_goods}  с наценкой 10%");
                    }                   
                    InfoGoods[goods - 1, 1] += quantity;
                    goods_purchased_now += quantity;
                }

                count_people--;
            }
            ///////////////////////////////////////////////
            hours = 8;
            Console.ReadKey();
        }
        public double PurchaseInHour()
        {

            return 0;
        }
    }
}
